#! /usr/bin/env python
#-*- coding: utf-8 -*-

import random

import utils

class Magic():
    def __init__(self, p=None, q=None, a=None, b = None, n=None, nb_bits=4096):
        """Initializes the magic keys.
        """
        if a is None and b is None and n is None:
            # 1. Generates 'p' and 'q' prime numbers of lengths 'nb_bits' in a 
            # random fashion.
            if p is None and q is None:
                p = random.getrandbits(nb_bits)
                q = random.getrandbits(nb_bits)
                while not utils.miller_rabin(p):
                    p = random.getrandbits(nb_bits)
                while not utils.miller_rabin(q):
                    q = random.getrandbits(nb_bits)

            # 2. Generates 'a', 'b' and 'n' thanks to 'phi' and 'b'.
            n   = p * q
            phi = (p - 1) * (q - 1)
            if b is None:
                while True:
                    b = random.randint(2, phi - 1)
                    if utils.is_prime_together(b, phi):
                        break
            a  = utils.inv_modulo(b, phi)

        self.private = a
        self.public = b
        self.modulus = n


    def encrypt_int(self, x):
        """Encrypt an integer."""
        return pow(x, self.public, self.modulus)

    def decrypt_int(self, y):
        """Decrypt an integer."""
        raise Exception('Not implemented. Note to myself: https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Decryption')


    def __str__(self):
        """Pretty print of the keys."""
        return """\
            Private key: %s
            Public key: %s
            Modulus: %s
            """ % (self.private, self.public, self.modulus)


if __name__ == '__main__':
    # Point of entry in execution mode.
    
    # Sample usage:
    """
    magic = Magic(nb_bits=1024)
    print('Magic key:')
    print(magic)

    cr = magic.encrypt_int(42)
    dcr = magic.decrypt_int(cr)

    print("Encrypted text:")
    print(cr)

    print("Decrypted text:")
    print(dcr)
    exit()
    """

    # Loads a 3072 bits Magic key
    magic = Magic(
        a=2661172793950545244018153287650611843747251084719750438105187915029580892775286423260617596824204076598084009359630996257749388448897236071958881382901477480194033669578412670653760160426643236006682958674488565113395636986383585210540738703693157036896850108140518108006781301291975776413553899321852860379669839866441084683114843198875041775367998291441912737111423831191785122275604098882430437570389297485809599415378432137163940522282667953451181681490418754047837068546190361505033089784740559525720910645327892893919954704227212276886197839224724867457898588960729730748225236404979697195615854954608683909987190752763719540884665423286763907472027092797855373333201521854979243109163865811061337548930613137041867174359024574165139185176793184476404016508192914323867444838274305329947148224535379557210535516771793201622983505643467594628706666422665068186663122996526837832552704460965279610625016100678412907625615050048233567964483759361950239964377553986259952777677718327285079380432774852300066017010193380891228456938982386618710787910698713479213135457459858211107033191909717833185946306014104098909485249963722717033678458391549733789913303632396873118467827932460542881593827915358071987795320051934677909385143256025248578580210743768052093300455155479678362098159851557153503205090394326771206570037748222378569418623661945869819272860837828367662876679801539871674617557600081506493666597987420008374210749010293887386689063333057106965612499125243892513026161375970123818067271949807554926333014136817683442177301736271400528751194140238573783812508534068037338473109765240314547777963132049183102307596716439769315644993733715387052712251859138776089084187692758238666916405120464069094710016768124693424553404371057331865541785527422789498546826796525030038228378621626481955989756524647939672680962385628314174193061230163,
        b=2656276065960809115594743564086538331040331099092593816484039713514778015534274859730707070531236291128899345718290708184925873406821863393150274422807972514570129159983355426604714352378104070570884958455945264538263410258082684793763155615240964095902268907718166788144196537369186951441324934345349287160892994311664188412289770854792648971862890440536975796246439152799464829094010819453970532514081232225154846575778900851057558762781089283230308878631108471770099853557598639823306189967570800884621735773919431584314805901688134062851803954021326048774581738773029845487863414302597202628545121567010349056405973983365022588977044472774971051194326704572539702458984860447915240698294853540217035724658054028411666847185566806175123829956593940785951401566191775011624137767481728208658676568299136149701513677168043600141158214990153680431956263718964758371743289468001975374171415986517042353425910666301974191331507160206217609193952726242502611558814246966091994462519752594354085338571070590509768128412652063205729678633576818401312387713483323425627014722346018401035985340779448425235715279764589986836893280559314856699301512486455532001138976257875365003766273842008494823981067262284074789908856657682271397540019719509637270871539099024232627442844059803449302534749255407605221551925761630282398125707877229988075670950581161689635968027234378765044204238103189346149887842656709698806966490198167796434670582380267100037694560662072593938629107261885012533352272936758491227519414900512840762355629764124144399456549283939026864251920195429896630804732746412578323558981422299264651774512685210403532521606970329925364073881799923321199521418434358292116036560353890396885498751711707951421973710100018812471820374249228067247273193903320898744767993002165099222406037604701208969198488987741812153728294157964298825153985401227,
        n=7783945383804463378144747561693797742213577967209537629028142856457855754304134408662399547406374796753867919387423356851708462496241387835644268070173751307819286277431333471561637637802227038764681481585121851385288038611573523157031527516665805657158993160266144972363251651824481217176047491918454644897640559048059119848402379805812957206949374021119414712306070392812444409066256335526050507122320980020723989326329547394283994103682038866440623122652389068807150929710340181752375452842870916656802339816079855756232547557338583186617200428866147987624340156227355160177690217549307330769568958230706565937009780244894598380538651388918183156643065960064000364522678646437685860360761007845470077502357311498055798200415458578425666453310812768720978347100885113918405843702406852976801513840470218960092263733803736775082082368674385748291049608341894533745855393969072490191540841207626089850378212300024731186596332110088954321733230919426651470045723776087033948068943556181357693058167901052926838336741403698681245694583317521680005664822543266048377289483802337501889527298721350559109907974318478593953824693369499099290250009639693295902338406009777729885598638366323665686151872159853908086479850607475009511458285070415856589203111305279629738266271812263815745392494826770400663632365768222371698835457324820648033084847627015109122177558884692977465197148910294272058425798590112291199687033921207767390381302079521537655184607385545913950343790322470916024395929952803157831011991369051746212536285225015914428498519175409157907514775781745789454579351367973125974755068411514692023095842383763838455505952220960483400580752605341461443901518207190836257382050211622688964438638613114046787263234539515236759494557733594745137063890961482772721996923342566773472254820960534351684652432002355087741993388162570547720611802319887)    
    print('Magic key:')
    print(magic)

    secret = [1889826732866202263054066356971903063159568322904265764036131010413447857680152244175937678946812011004877336863370475708891630973349031560273951428133310390963429953103472839490422978594635280293093155509570413064262244956158263603565224788968655866748693327669118230674819850622256191651479397399337533053480197410850399153490954324267814437958912638693970325613569096754561138141853788036711126564960005792879360663918445390834487556058477996405162703879186242449033745814717959704232052554453063293317748313302252657321922412558919034915991311880653791043471258318209597677365088227272530968998229251598169708785872083185812284565277403500794781406480796729998112743979336628470371724627308985264777661041756727989519520346796902869177025706876925598362202004796401293248327555996606022516814347237225643831498866385990621845474184527654522130730988197379225698039349853177778777521198111428542019230955097702681376135924504948134717082645396873573321318060803544070397940350235143687925742815237961722134806401823004710925938255497235163752626536407422220014460594711521053885211679966499180842270309776971841906116342286257024285573434682809314919429126354723935342226243241459878775499377903822071342471477974175090932896761602561738377276701339998377083970645505044874352545014505810817396170805025717060999638356412390087237577688112797132474030832900102803332088292550214386448255818441642294486624946244392333043844338290829879549570426611193133134189510159830196306224360597929030678554142337495382627837576253563573409913148341557393496313229897833209023996233240971365078734202929360336551022509945952722652876463613811270189131707609546343055416749855439204001096574511715025335586785063278217956174083556339840202766548000185454366769851273735483134165161184444951961949303083627149021843765405016063830470440006136565205609377034190, 3674949925541023548527337094307883322855357711208442549680597717938321397571162973252024775823550294049397577844287977015487730729778985532802980874882621930987056939986085194069201065393732211535902287615353276270714209530023242580359814821942092129982861401001399883669536682803578185815591348372964780221093024393949195994459244426788057527765510325622075546356980167490934307947226232374770608945468800066346916873455462402457252933563692483035085769287200879112246443626077308881790449335660278143028464506177519312403799240432489497716711900327597675728711941999255443783709657343574526414186995037238477444272300264957015599983210072464537320296180418853586530073840171537514049221016093563956506863235297445986196442972761334826369937195199280096855645402748329149223811356084353213207894672158914138946939616614073622088802720949671209240122340435391508341125690320755676241368043655237311336172318204756794820168706788908532983454556733497794636283375826346186291599838815150041996628991761660487434226279485483983397424079830365822195667946187032785686144686185114025955220189191206756381997182579013400917483994662185353355434038801208485179685049329199051544257641667085193575212274309353625933949504060224633615446501095207174426459531160691627688436227388922534788255536783136766188537406739794445362255452246086181864373472153735045046186021174413561493062322436755546794970992053111172910941450716237231319087276082969101816977055819406068079303989853335066162559840711167394241861901779464593942379133367452327628089228379527418632696167581298816162813877910081467106163032898524625765564872906275892203592830592609327872248264160366550145091139895094384917274523874958192829731245875976714895302002516573366606420105658337573937310147016958957990206036331187574556739466205612745744558566823139567919708685608233147890362409730566, 4055524317539137973478846663026973869241312737751562579535424362514693248903236916023263419798972703068273106059553858450134410597504264817861990850881255024525857224563205724423625600407155349852670169712874667350295830232783435805289729613189587465805097562522087825514039191268417068051090206756646969085455585213259181547639463897597329550751314014614175489441185692020426227200810379906633642343115960556104226087384903685484068629034917956310740824727195443672730260338089490549589196800596480370803878277708563576128003500736808091450071297286212959361374803219600391783969482611973084969601488051643067931731059951619096070996983929191884640377256643354607065595097772091010787068257626069055121774584857622516306379099840479574252425965042246882503139451766793516695655442734853896844818197977890749835580894274024566003199994722371202664557065156079613903279977931980230122327836667999450292901245887076065232772682113310931879467143191204537762462761630068750892192502536791875196499692708335558400386336420663729331891300927401783419140155526623514705531845810330108413796877034143133059692229856240763591674838697833437769156069012972459152743881249648954066353386183232396339613434373606931564086207711231509207356129696849023071771370766270685629314948011523664881743799849948507831904418165522985905551733288524444713475973049946798717086422197739736730167563447473488288127107379479221917485045404412924327522401472439679933845684231664741155702896381336019948930459775208384585926078848641069351402226154348201939477657120777780767544134327073611633494786920977754695810852307545362916248913574714598222497379095329379152595169078865529135741696469094838620578376984480579289781142455997419666776778134426327558171736939267157805802496314656700588999579358592384821593914513424941061732641342802849130345655909403195766702011720791, 6301970878191805657931161071146641247964590937621963793655524305520510618005952270408716742617931557409895658702260147714440642246609261533499697794175558145321192006070926791973520384036882786246509287802745890426778197397420705616205775198393904019852059931423607040363818829015228258024847303674356326671115591801233698450940195394649723060108849003473922847122349995316844803183350568427441829727020383888953000118270119165455712725099304774595434656393751206588300171153450686012449403404553102889619733312836898280609860746731776371603564740827269759197604633237891476589465783964867711079927145494382660792918519050918060071480147096912767422119773352281724832204603621353230831435765549672425498101792108941411622524981212510130146052861480553165539228739854203065736416735101482396698163316705038128488544604403800622412909435663385088220360820188809433468607831033391254560596903955217581997251363197350994582250921509241735121625284578231147591861653179607606454244612401580537645807383841966471754300565943394145797306078270295860500287433437343903949782011098368619443628651124348424320346787663426387785547955276391860272922152426635713015978312725293315590298851844842783476433699271282695867253668488162624350249402112097242795809502555491240619983331933521419861923818598369746679677113042043286370617153735664798313902598265863085935198325635354529318054327165546123475296966880094397148391737215831717974137666599526249480476901256226279317157431798719682692998893726706359011789274051652918749932922442562804487309737543741637829938727102242074597869271949276224849214615028899221349192317945576593164116730802964275357865093138024309515851023926962530370364103919870077200867148282471326121073351156196369033181625335264726166209843840558708667140885199342438433681759051634560245383693212333594685488639777234325191724210576209, 5634066685567029761197316535916593786089853858733102837731557641660431787016153047047008544955813343423628724951971215197033703144235031922433462595296552442754613708866524015308558963784729169956329097941315596998727694306948803332013394818189501496781425491040839844811061096232243811748072539842154147179055293969080865100723141627046677624625057563974795494894866799616589136808737996465149172322578943405825037993263733314564638781548780608635163202147645092075913877288140083579481103021056740575826248079965285015777985232814538760387947731591329437848650383041003189535658184568693471895346961196908625194003401600152263153446973501673607988657338782306285114751385311761864001336331406658326793390743193174531288421373366986542446257909700472628342877134810258913723627273057910928430943254301442413669625806711690052806580037638391751920564872819618922054455771467829741303579692113977539635524720795905005260997196751484092684218192433864160434659421105244509041966660362749058416544083100844946869780282615159645154619189362902369590124883194360164542283294441976288605056657049794017734759151667743535233497189539424268858743232960928814448952515557523319700858287766875362731622970849452636600466563647567263305081036624141244416891092071189034393029107359702244680890651621195040329969896748660998013646600427042809042115548163037311012140739086598977128466769077421160816643486521077197815016159740161221052633635083135839913736313422129026702889682515524140831501710300080490433312885075898655624648100059562645678124043221309901806242220251350586957878272047207066739202545801401525998138131166939188911796962210992026801468976019056726754938927155737516562676185664666922017522962839957107042134646288923528115430225772606024936124933943209141220355246104093623494064394269539900450508484845071053811646154523127884150990145955972, 3685490780951851133447123097604229245558014412013272354508749799128843633378778528559353676691097354586999967290894012069463766802244754136513256072674660933606839178100369574865274783624080833881596674242658140000794531934872479598376445155591493495408837205840036071156824416063815159352011361111760423517167770478643944071894975687171427393478006055857272847950214158617104826165284289346022380502052125101986955389960791417316954002774422142195054561969109214784891143691799027373918093171115077883316888898320243799888491164174449531319228221598797717747435622640137253814456428185701241206565539686494068281236508920615996909987390907616499527380046887156300633855969180481289275623124617286732982507232488553064440931267303944750758175701245097655152538379512027642628106305118437284958327657751420780431871029869536066124367936054499257699037817963294047098042527230184923034857797032442129419163661596272241103518102292082289090731759662031470366712787138742881794202665355226866677962265051105091694676687500565350822655729145102675997056933867549569652934308164249581518161090110428556061023479369009245933829524978166747866847306101567284287964587128690151874417253566455472344468191822737314688867642922560131946478562982679233939643109957001894695705936622447384478118969609344999637660732215022845015066085986931806747161172861416248357511421215474119568473784582934580036786704070742178311241148452081391077719716839346938978187114420101207196733693614577727395399584258143278193791712064571589661334971658364374201246162645842774170233720938677597987649881470136014083202224662594048169359930730185727046136672211875134107989481963479379223260418836716060882625505106958882677764076799993536244189788836770041506758276747279246752749264306425342928904820939064828772778288792790937927442691898064863257436731878989195493173050972020, 629801335299005884282027798266181590455335790718180269009838359976362474604395101159237978655908620000079897792437022299454060835291498636670282383855460301426502465576448909511152438578189170834089509237056232613739243046935174401022649831854554006738257109712442543241665409714910334338652658561602374830489645413523203334872878233752907990192622754205552718491792712775275238490074628973720606043356657640093534222412977301873306403487362154165689378315355467412871623019456075211576095388267859816486617230810776518755864031370143235956834992000595095664608154064753056475634742550445805755239875519205571425484712820838338867362335480060985115374169114037825465945474561778178614382721771820482618824545785093731372670104497808009802750189659869626050315080023561947787444619778126915361627830593912643230024046166249804893508213157329467967407052308172483423705577894002598115901904488774851444250923182091332842510078187880240398766015800307173568735733951201313255785997256935810159810599085061824188403615936491117954488125664306812861586999910825566928758041220032327886713367475749955863940794963433846979367025536907009094025567177380517760415294805289199784202456253966071819785656115715255662594880434309177292247708325362008717654640063758386909415823517346733597027955345617242503150510664149978235065047010532291911485607966296333595578006560984865788309299947274485779680491400526814270463759058223707956070162808784876612384948798160097498279701948180233263141574935140242491716411593055447166666251641229973923649101325076800766081651988740332996942563843268055843335170351674454924842829604782274648874659662543626967903876164608834460707763564385951348346512831964628437627242230311577284654080917223502249891520279821558876378759092509434916588244116099725161890256224112873904830638746098565269014943806904442309054654530122, 45842211147365953066347430140400504852758951152769683899946761975914184471652738205000143809140067685630211681054708963532051289204066523345350647964991494050622274456878002087115966339675523253097785363825756122847838925898348021336021962755016739000851995146199747137248850633416687536599661964026977868081488495137145747722868583166273796477678559573692989934678084777115618959159553449080264475889035104790286088189686874578538979314769605293033580041986078921860321120293784304183972772419091508632229112617410364672361479392808363135648597181031427989154621921963097367276099273723587417506355867226137044895398771856795305091371247413560269239741707574119554857299996502025536012229802123280384997645729612975000294775858574897618916741342225369237827440562752913958448398407441722436684994841740380343306316541303796836271789422558026647983372857137678215914149557497354486894190079710010829863467178633230570426465022715188043757106812165506874291832256282028203759239047058469808269160735734142336024762869885644756283951438229764578729036707909350436529299309637852199077703524583363068451852285993924227377056728919671815048396652087830331411654236245424738346474446708378600399216080271309117258566367914473357757112440823160326340478285102459051589198112472800736046536591816967207381313233005838033048154310664469561499700611405013470458220140398488943143562257755505878498288954696558032900605406345221809056759973055866297494288469604662325588024847253895119833134236754537361529547139957591105024021190252514684875372850622378918332702134723505947600137114932309370726214409467103406977317463109069775512100540301789650117629570999418609143781884230748014752060159110994676864356639768508886242916368699171470310862860225405033398497575024982720609181270863546488120442266143137685596616653595301835500274790802082631225059412421, 7707210881004011012498142401565004969854390348564307065649675269496530543522470172452693027231192621333352759460177556519676828638214569545445434824939444356973411156512383863938076717637648096211300619067370290121310793602200435069541611576396133381726588765024115175791631028665925064929529325451259751415052169884829196850699825332664222374286223956083669745438047294888553972786667686530565533091323644091403051842230139983560358132714891641002223594675935597241325378605442585967446030150383186432096799277123785126840506927823398450791511717982741828827278191026741802038211008660874573607864852823153419256969920443778866571061587563785284806804328521679602520201090402682605811906637765123899532346110297780713357707221619779741596595676055369904096239983735357125928086384577745048259854316919090744031074201895012502834072211344866324618327885934074353673677945551223676572363293193915029959144257926548903380662753258203231241318479452052951580100575808227614124159064003147910393203960079244338793360958977167541181971785204241026143661966786414728120773022965226468852191081371337073157739396035176105932381777014646089032846188468899607893077102882390670112139275169921321028855431635863953109398626356749832837446334583909848852204693308661553076411112758585273168501407112879433152703210804728330938350296662517472229111242333077080519689625367164554222999325579432714449148754140903077551018208228993614237989442032194588120369238450254903147901984744010278851844163203924718531013919215557925834648576925089201271730154908065769049320660518382387128096346294835678664033771990707579565805832010269121674595923347672758237417032923842110353502577525600210298756830180818310335178798847998892152879781662781931199306719190666800406477801287099421969949634140144072254964003750323605371670863917807456287457958412442887566716481277083, 1833559492241606152314455003243550583413169099347787856981887878739293978060864210236824919709315596501586331588034769161107904237784802214573806558718083060841463010588195613807389404009267296692605558369224779204496044581738197879137876461025301449418379317135645666137692996525717196607013672776561248762496863781718354150145279101499465721530380779706968757989783348691638768019136279222461931694396328353593992612802250203819832337091708647215881730477319688059736013073342164779383158223304795951941793314691762062068663266355515593630289634721375079499974479916634675127589246573793463937182016773547208230269108284372565213810316632983080872809657016186683682181180953536443762100231750580624934886497315991819879403978170606630764266193105637808433047259673797792013268290986473336976706673106610709219142515976397876409611264107225181228498997661148104682123418002524224695506274759513759931867751144092440981910482688632875036902500805103172498492383944771640167630264684734184539992673512776547676699255479598128899117648524758462723981829217147031469378863209190623659694190153045721887800192635082683331762982670709200199759889509518179194502838278817834564774356192938404990037779008121590406716950448798040858018107975734267053621502912467634385464986980617674174246509734163470350277631497051687125262453730907480175275796187685531948220954081414905549434919901483978434321563501838893338923335403311900438451140979313166702710448223460872393167739738663010280636005545234564190693779499085577987749434721632290342683253426645040839085309821086562378982315894132323952824792340334773824383416346642143346656552114829227506031961788166204697156332688385376642299702449293288360189134295718232440060720925216261905289380001182285963974255806361679906016343002839181379167997914329276956248652959225372737814744848571660075657709155577, 760709961319349437324443290881662425961257451657197734369739931509493490260867565525216318818144739463115853761276618213152771515233637558129658580421461412363048924792677981171216162901276021521642370727343128267500411557744271547946334623521499451355536562372955474354122163779442465545469286956373765307790668779581958870512496020441031144611551799064677436723908589745650212550639125809554843738618860455936659600588205894656828176545337205001913504897650846648588955330582128198625075838303981886375877984333439314273032698896453634509765438303665431134086785471650591416883572122063680640440879761464713225562112605166677816575634595729462829634758412456256356092492498074722732963519459922782492248195040075505468486915606064273156138520670528341616159935062865576694228284579383609545750498345042622917009705044632491785161301137835851454220370418299156751742308999668870228483676845850880134508483086793725324817759792407988739128038371741732955191107418498408212459264332583359620353378512969841560022671821988166555966870349027097571040459290554546335307941202584602812786245964216982490558201146160789396006649894291480351067482616317209715099850555388238039462685965720939597112268852491458246379475977546169718479381637432659130070351410252410307056803110087112515649816102210677810408863355040943039336491227586873934354043305857776693939142056234837437871703504319496612923663613607635995263710056221680218014683891939249900904008045495367709881227084582158998167748187820752050314078542857538941716348769437568950858046942010526259269030456365604711693459506318524376374799588664791639715894739258383683468731613518064002060547313668569305746899744671891467448796965527857688303326529961406623829320016013285642609741538326346391533723447939422187491823032963886711828244369307130612281067759020544460298286660940076805140247601656, 3674949925541023548527337094307883322855357711208442549680597717938321397571162973252024775823550294049397577844287977015487730729778985532802980874882621930987056939986085194069201065393732211535902287615353276270714209530023242580359814821942092129982861401001399883669536682803578185815591348372964780221093024393949195994459244426788057527765510325622075546356980167490934307947226232374770608945468800066346916873455462402457252933563692483035085769287200879112246443626077308881790449335660278143028464506177519312403799240432489497716711900327597675728711941999255443783709657343574526414186995037238477444272300264957015599983210072464537320296180418853586530073840171537514049221016093563956506863235297445986196442972761334826369937195199280096855645402748329149223811356084353213207894672158914138946939616614073622088802720949671209240122340435391508341125690320755676241368043655237311336172318204756794820168706788908532983454556733497794636283375826346186291599838815150041996628991761660487434226279485483983397424079830365822195667946187032785686144686185114025955220189191206756381997182579013400917483994662185353355434038801208485179685049329199051544257641667085193575212274309353625933949504060224633615446501095207174426459531160691627688436227388922534788255536783136766188537406739794445362255452246086181864373472153735045046186021174413561493062322436755546794970992053111172910941450716237231319087276082969101816977055819406068079303989853335066162559840711167394241861901779464593942379133367452327628089228379527418632696167581298816162813877910081467106163032898524625765564872906275892203592830592609327872248264160366550145091139895094384917274523874958192829731245875976714895302002516573366606420105658337573937310147016958957990206036331187574556739466205612745744558566823139567919708685608233147890362409730566, 2006618685603034211914715064582696490599977046021542709455848903824241097433794542323580373249172319435788148692749518918455779709851676210612487296022104514928594280088868504852443467068489876306429045420310478147827978212384180571832907292224700747581047312930331840137433385829902346141446237840368739148079481204272504887185739539615384545415807639755220158319650815972596295331056202692867084919338057612425219957710152289132383942535515921065209827732433452161753163668800646180820254935638582044671297311736990416913709174019671238218170564787130348533581433427086862968430357097492691071574674351125116612284941540423818528606142050311393664452736864168147759570711289933021073184133570281655528160252892662085709326083557217016166011056266603985018500138353697010987595125476265509192455462956044865086143988248730755276848270997817366400114102035677322507789075901300493947422823970655244772714857076179251331070207244389004614230793950310002180685550273267216240909711675248909657059919765452215145347000898409367519975564444526912673204620727478540835500961423506738204084594900141476111884254621429215605567006176216469288324793610817175052703423955934074602988533766249889860029034523601299762916488675315738955326627864779235690500837477381018053120963606546239585815925214526644930377698983213115033320894382093049932728797363225774816862297414359159405594847935060785330719293295804857153956092330217689202299907540216067811557672491090564506600569212293818820834149076905369608168011459563172173221560264257964923827823151893111128774100117627989762845096158155370391127612389526773536062064488815785837208348386294979349664135258462873347502671447074711684086828313836104371853193735729332938567026980645095022821514574916930680591968152335561884941312941426640269974939713094780124552791801651164072181280812516883657298668775887, 629801335299005884282027798266181590455335790718180269009838359976362474604395101159237978655908620000079897792437022299454060835291498636670282383855460301426502465576448909511152438578189170834089509237056232613739243046935174401022649831854554006738257109712442543241665409714910334338652658561602374830489645413523203334872878233752907990192622754205552718491792712775275238490074628973720606043356657640093534222412977301873306403487362154165689378315355467412871623019456075211576095388267859816486617230810776518755864031370143235956834992000595095664608154064753056475634742550445805755239875519205571425484712820838338867362335480060985115374169114037825465945474561778178614382721771820482618824545785093731372670104497808009802750189659869626050315080023561947787444619778126915361627830593912643230024046166249804893508213157329467967407052308172483423705577894002598115901904488774851444250923182091332842510078187880240398766015800307173568735733951201313255785997256935810159810599085061824188403615936491117954488125664306812861586999910825566928758041220032327886713367475749955863940794963433846979367025536907009094025567177380517760415294805289199784202456253966071819785656115715255662594880434309177292247708325362008717654640063758386909415823517346733597027955345617242503150510664149978235065047010532291911485607966296333595578006560984865788309299947274485779680491400526814270463759058223707956070162808784876612384948798160097498279701948180233263141574935140242491716411593055447166666251641229973923649101325076800766081651988740332996942563843268055843335170351674454924842829604782274648874659662543626967903876164608834460707763564385951348346512831964628437627242230311577284654080917223502249891520279821558876378759092509434916588244116099725161890256224112873904830638746098565269014943806904442309054654530122, 3179662492351839189875525777700498903141562319527380774246307104794553059559015962466672540755544664051509332047802097214961276225143064680753479052696792798326631788827887282992363493495984881369425616902905049975124954172484338973292790002239479773654364550310159797233003309214987438221678871046631722341531470055173600310461065290324493135879283628883621933289830254344348103789057639633476220763020609886543123709072289027743217859893175024339627796240258155884489966948461977627424995575147916915690869716168974362920459724937175552809235474338749041289702369601545201521940193377067250747900306307971250163030568065339933650845678763594880775423155495065973459733779784586480137016285143335107329571982716540634305294663379775164888551530318911658703864597423925407238632648695707452035850470035289038289670162993262079576260979692672945532887817872996813368794480653977197728681193861992369171066154460420070724263344175076675084151176525789288678556706595540347663898031880979128496526351419638192907225240197216063411028770780798209411505976929191097708338206924963735608002477309112367266780608430513760938918825808295949325616111527609238100430919481577533552431451581749852346631514705641165290574901775686903661861836106263056394992658141821771009777930014665630415554779554565484552222144507571722657737499279103110338462493880016723388153904462230491107574385923784068673529926623150187419863379240323710144949681556632274763488948511997816724962320044628000182564436954376622908969491993524652623717569214806012177303409774123897479882451279309272545114337536031578848545986162571516951787658828289893493049831745989793033022918010275554176725646452877302275426797608993967755781553831631308773347647007566943111034756660817635078136320848802912250842710050698526160317775194478899170406708646197518687965923126282474040089760801155, 218096504362404806312744119970984619072227886853370292970754700548430399715380504966319030485394280836964923758378568977536850953885178533529860050784814667256596493174047301065948798404198625436851100741046613399258879564717671660828551513686024843936572487384790401168145925309477794792979987580545325872656310114432267293970413877668582699008103764282147700369600835588918596522742731616669156008832225182245403627573610998644909833982883965512227708473235096280942187396352601652122301688358717473119399415135464868229832246149292721500463259929616414748605613527024273878104425813895095873250516947638583350292296176708121185426515372395485671314033408615929475338771260645561815686038159237429686170588588002512262379254859955633521790493012742451919778723279828435691242483190472491684494585347462008990387227939068687154280666456281468701150561824990349979048092292022248629017369615750163798814537067694357089412528139845514444598863265500920630105523375012377209690856220533173653724086401233952903235948123889015541718421506498222014720783649265510656712198750249189939576897336775123608356085732470269723346235453744400045815368077719001908910123937789600704797486624364142865821620312286872044959807133654058027111733535451148191116308304868495773559691576867399134181753988116815978535974239992495612553041782912873092473712807931345511349488157427108615348514495752303292116576758059844787955192039733464410656734888411049441318620472912474629894594745058976063727679580547006633389672601320218979803355331973255249345112835737590864769124594319181016231291030599335427304728995379372704703148317790931898863525007206307230915145570041604913979792221198518780851982238080378801742871041943057717896570489984029167153352408444207124267118986177419787910513910742310739983891253755801912463487966082224718856850533775186145354820846001, 2605290557016339498091438585813944556328015793454883331934559603358595903783438059288087584602645446755117375112729896675826921944981545420442588854033656173095535179127367954350405074832348273465484752407437642061469691260275902042123976869093987647428158124704581967236411260569583988435814512518907880511618741363876107563039311394036904560640913812161372782610801458930205229314126806821225567518027796020966237752822076326133407298415112144167451807518015403287876331768730661726864037326562526518389993253568533848755527412952699190801255131642810990557819320445567327679858704197037804173875964395293126694235231221716722489842621639647743276771442023168325527522622890019740863198858010595625758380974034415657124842006272163882534664485115646739748010599487864444611320975095310260314154646358119145474384051284742686096180903050251585282107178240302246647406681968330776809120165615113157501588018366335003050568944663917882601396800934545346279780553103052255896995551619569629945984174019489560675664434488235570265502390825421862625983842717016783994141707232580470722957672099683456572361049184536929150959611735641592714601413111778341464210528271812684758381333707194041725404493639570983268400152807576354924748611667905300034503006457931962947222380206806063907801179736861678377535359482329529650326970828683755854280048078044976598502101691967077267991149285120620432945725238381600120347966954408245222018372705133865439842835306341906629022947449200220668977447751589796499323784983923745384663553683897904723235183725491323626064380832895202038311040598777643628851289029904102425156091595767322354628225635814269837867700376107941142859908431398885812017094393677181419105113606188717543616114721028161835388242704957090003107708848955406194440062048870926018275313522793924207939001233325685800064453840832589622636515707411, 6301970878191805657931161071146641247964590937621963793655524305520510618005952270408716742617931557409895658702260147714440642246609261533499697794175558145321192006070926791973520384036882786246509287802745890426778197397420705616205775198393904019852059931423607040363818829015228258024847303674356326671115591801233698450940195394649723060108849003473922847122349995316844803183350568427441829727020383888953000118270119165455712725099304774595434656393751206588300171153450686012449403404553102889619733312836898280609860746731776371603564740827269759197604633237891476589465783964867711079927145494382660792918519050918060071480147096912767422119773352281724832204603621353230831435765549672425498101792108941411622524981212510130146052861480553165539228739854203065736416735101482396698163316705038128488544604403800622412909435663385088220360820188809433468607831033391254560596903955217581997251363197350994582250921509241735121625284578231147591861653179607606454244612401580537645807383841966471754300565943394145797306078270295860500287433437343903949782011098368619443628651124348424320346787663426387785547955276391860272922152426635713015978312725293315590298851844842783476433699271282695867253668488162624350249402112097242795809502555491240619983331933521419861923818598369746679677113042043286370617153735664798313902598265863085935198325635354529318054327165546123475296966880094397148391737215831717974137666599526249480476901256226279317157431798719682692998893726706359011789274051652918749932922442562804487309737543741637829938727102242074597869271949276224849214615028899221349192317945576593164116730802964275357865093138024309515851023926962530370364103919870077200867148282471326121073351156196369033181625335264726166209843840558708667140885199342438433681759051634560245383693212333594685488639777234325191724210576209, 760709961319349437324443290881662425961257451657197734369739931509493490260867565525216318818144739463115853761276618213152771515233637558129658580421461412363048924792677981171216162901276021521642370727343128267500411557744271547946334623521499451355536562372955474354122163779442465545469286956373765307790668779581958870512496020441031144611551799064677436723908589745650212550639125809554843738618860455936659600588205894656828176545337205001913504897650846648588955330582128198625075838303981886375877984333439314273032698896453634509765438303665431134086785471650591416883572122063680640440879761464713225562112605166677816575634595729462829634758412456256356092492498074722732963519459922782492248195040075505468486915606064273156138520670528341616159935062865576694228284579383609545750498345042622917009705044632491785161301137835851454220370418299156751742308999668870228483676845850880134508483086793725324817759792407988739128038371741732955191107418498408212459264332583359620353378512969841560022671821988166555966870349027097571040459290554546335307941202584602812786245964216982490558201146160789396006649894291480351067482616317209715099850555388238039462685965720939597112268852491458246379475977546169718479381637432659130070351410252410307056803110087112515649816102210677810408863355040943039336491227586873934354043305857776693939142056234837437871703504319496612923663613607635995263710056221680218014683891939249900904008045495367709881227084582158998167748187820752050314078542857538941716348769437568950858046942010526259269030456365604711693459506318524376374799588664791639715894739258383683468731613518064002060547313668569305746899744671891467448796965527857688303326529961406623829320016013285642609741538326346391533723447939422187491823032963886711828244369307130612281067759020544460298286660940076805140247601656, 1833559492241606152314455003243550583413169099347787856981887878739293978060864210236824919709315596501586331588034769161107904237784802214573806558718083060841463010588195613807389404009267296692605558369224779204496044581738197879137876461025301449418379317135645666137692996525717196607013672776561248762496863781718354150145279101499465721530380779706968757989783348691638768019136279222461931694396328353593992612802250203819832337091708647215881730477319688059736013073342164779383158223304795951941793314691762062068663266355515593630289634721375079499974479916634675127589246573793463937182016773547208230269108284372565213810316632983080872809657016186683682181180953536443762100231750580624934886497315991819879403978170606630764266193105637808433047259673797792013268290986473336976706673106610709219142515976397876409611264107225181228498997661148104682123418002524224695506274759513759931867751144092440981910482688632875036902500805103172498492383944771640167630264684734184539992673512776547676699255479598128899117648524758462723981829217147031469378863209190623659694190153045721887800192635082683331762982670709200199759889509518179194502838278817834564774356192938404990037779008121590406716950448798040858018107975734267053621502912467634385464986980617674174246509734163470350277631497051687125262453730907480175275796187685531948220954081414905549434919901483978434321563501838893338923335403311900438451140979313166702710448223460872393167739738663010280636005545234564190693779499085577987749434721632290342683253426645040839085309821086562378982315894132323952824792340334773824383416346642143346656552114829227506031961788166204697156332688385376642299702449293288360189134295718232440060720925216261905289380001182285963974255806361679906016343002839181379167997914329276956248652959225372737814744848571660075657709155577, 6384368203861499931436837338405406218821491862219497916558084300539817937124760887897997883720536638419441609626955682067165520018497246701950743734465163621099177426932814658831900726126553529279214063975797390896452147444781787119818373113758536658425046166399090029472102876366549495969276745499515766038849544864148360958647350925060774513036812115680998958457077642190100128921349279213885247415760887789066813622463981734111952510251514913702953185892024174256585050130549961468256633980977721386372244157921422186029970234481504578669571618970174992437059757382104206560128735543378618706539512996880937304929512437921530340119713045017245653944649098700874258902767009475364693595777358979276171225769507431405609191704203484656011715044074053971246896702466243960893170783666284432745707721053362737462830384226447003642935013747439294382383866531487466639548631024312206053453504193188696994869176024482665404677290796493698800423341691295840020068055015893528921998675642628309720665994218537583938131467306759151973701466146474596758069005723628392937281002570327237008994682141894131695851880857019053299117298310230080295804888227779727146291583513102218413424592111448140937113921053465611508027698566358071666107935719325947782748280034050726447479317966605121125841440003333042905027974199748984098420297708870891311756477710949952585402383109764618306612441303149955283632049121687132807011329233858265595309994157759200660064225726722285287150205118623488790229324290964984975113137796552760938407014856248512610608992450256607005499269654053461274718717613273709630185713578574378542322580866822532760372589412328688592925819967108643574189652600586113236950374036483396863452477730857833889223054159474966237016704173786762718989698773638150592948619368932093345810143846063633411486218121633304709539711033487569247496046773999]
    print('Decrypting...')
    clear_message = ''.join([chr(magic.decrypt_int(char)) for char in secret])


    print("Submit the following flag to https://vestatech.cybersecuritychallenge.lu:")
    print(clear_message)
